<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Personel Takip â€¢ Final</title>
  <link rel="icon" href="assets/icon.svg" type="image/svg+xml" />
  <link rel="stylesheet" href="assets/app.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="title">Personel Takip</div>
      <div class="subtitle">Beyaz tema â€¢ Siyah yazÄ± â€¢ CanlÄ± yok â€¢ Silme yok â€¢ Not=Ä°ÅŸ KaydÄ±</div>
    </div>
    <div class="pill">
      <span class="dot" id="pillDot"></span>
      <span id="pillText">HazÄ±r</span>
      <span class="clock" id="clock">--:--</span>
    </div>
  </header>

  <main class="grid">
    <!-- PERSONEL -->
    <section class="card">
      <div class="split">
        <h2>ğŸ‘· Personel</h2>
        <div class="actions">
          <button id="btnRefreshPublic" class="btn">Yenile</button>
        </div>
      </div>

      <div class="row2">
        <input id="inpName" class="inp" placeholder="Ad Soyad (personel kendini ekler)" autocomplete="off" />
        <button id="btnAddSelf" class="btn btn-good">Kendimi Ekle</button>
      </div>

      <div class="hr"></div>

      <div class="hint">
        1) Listeden <b>kendi adÄ±nÄ± seÃ§</b> â†’ 2) <b>Not yaz</b> â†’ 3) Ä°stersen (GiriÅŸ/Ã‡Ä±kÄ±ÅŸ/Ä°zin) seÃ§ â†’ 4) <b>KaydÄ± GÃ¶nder</b><br/>
        <b>Not tek baÅŸÄ±na</b> da iÅŸ kaydÄ±dÄ±r (yaÄŸ aldÄ± / mazot aldÄ± / parÃ§a aldÄ± / bakÄ±m yapÄ±ldÄ±â€¦).
      </div>

      <div class="list" id="publicList"></div>

      <div class="hr"></div>

      <div class="card inner">
        <div class="split">
          <b>SeÃ§ilen Personel</b>
          <span class="badge" id="meBadge">SeÃ§ilmedi</span>
        </div>

        <label class="label" for="inpNote">Not (iÅŸ kaydÄ±)</label>
        <textarea id="inpNote" class="inp area" placeholder="Ã–rn: YaÄŸ aldÄ± / Mazot aldÄ± / ParÃ§a aldÄ± / BakÄ±m yapÄ±ldÄ± / BugÃ¼n izin aldÄ±m"></textarea>

        <div class="btnrow">
          <button id="btnSetIzin" class="btn btn-warn" disabled>Ä°ZÄ°N</button>
          <button id="btnSetGiris" class="btn btn-good" disabled>GÄ°RÄ°Å</button>
          <button id="btnSetCikis" class="btn btn-bad" disabled>Ã‡IKIÅ</button>
          <button id="btnSetNot" class="btn" disabled>SADECE NOT</button>
        </div>

        <div class="split" style="margin-top:10px">
          <div class="hint" id="draftHint">Ã–nce personel seÃ§.</div>
          <button id="btnSend" class="btn btn-good" disabled>ğŸ“¤ KaydÄ± GÃ¶nder</button>
        </div>

        <div class="hr"></div>
        <div class="split">
          <b>ğŸ“± Telefon KayÄ±tlarÄ±</b>
          <span class="badge">Son 3 gÃ¼n</span>
        </div>
        <div class="list" id="localList"></div>
      </div>
    </section>

    <!-- ADMIN -->
    <section class="card">
      <div class="split">
        <h2>ğŸ‘‘ Admin</h2>
        <div class="actions">
          <button id="btnAdminRefresh" class="btn" disabled>Yenile</button>
          <button id="btnExportExcel" class="btn" disabled>ğŸ“„ Excel</button>
          <button id="btnBackup" class="btn" disabled>ğŸ’¾ Yedekle</button>
          <label class="btn" id="lblRestore" style="display:none">
            â™»ï¸ Yedekten Al
            <input id="inpRestore" type="file" accept=".json,application/json" style="display:none" />
          </label>
        </div>
      </div>

      <div id="adminGate">
        <div class="hint">
          Admin giriÅŸi cihazda <b>tek sefer</b> kayÄ±tlÄ± kalÄ±r (Ã§Ä±kÄ±ÅŸ yok).
        </div>
        <div class="row2">
          <input id="admUser" class="inp" placeholder="KullanÄ±cÄ± adÄ± (Ã¶r: admin)" autocomplete="off" />
          <input id="admMail" class="inp" placeholder="Mail" autocomplete="off" />
        </div>
        <input id="admPass" class="inp" placeholder="Admin Token" type="password" autocomplete="off" />
        <button id="btnAdminLogin" class="btn btn-warn">Admin GiriÅŸ</button>
      </div>

      <div id="adminPanel" style="display:none">
        <div class="row2">
          <input id="admSearch" class="inp" placeholder="Ara: personel adÄ± veya not (Ã¶rn: izin / mazot / parÃ§a)" autocomplete="off" />
          <select id="admQuick" class="inp">
            <option value="7" selected>Son 7 gÃ¼n</option>
            <option value="3">Son 3 gÃ¼n</option>
            <option value="30">Son 30 gÃ¼n</option>
            <option value="all">TÃ¼mÃ¼</option>
          </select>
        </div>

        <div class="row2">
          <input id="admStart" class="inp" type="date" />
          <input id="admEnd" class="inp" type="date" />
        </div>

        <div class="actions" style="margin-top:10px">
          <button id="btnApplyFilter" class="btn">Filtrele</button>
          <button id="btnClearFilter" class="btn">Temizle</button>
        </div>

        <div class="hr"></div>
        <div class="hint">
          VarsayÄ±lan: <b>Son 7 gÃ¼n</b>. Arama+Tarih ile geÃ§miÅŸe inersin. Personeli tÄ±klayÄ±nca <b>tÃ¼m hareketler</b> aÃ§Ä±lÄ±r.
          <br/>CanlÄ± yok: yeni kayÄ±t iÃ§in <b>Yenile</b>.
        </div>

        <div class="list" id="adminPersonList"></div>
        <div class="hr"></div>
        <div class="split">
          <b>ğŸ“‹ KayÄ±tlar</b>
          <span class="badge" id="admCount">0</span>
        </div>
        <div class="list" id="adminRecordList"></div>
      </div>
    </section>
  </main>

  <!-- MODAL: Detay -->
  <div class="modalBg" id="detailBg" aria-hidden="true">
    <div class="modal">
      <div class="split">
        <h3 id="detailTitle">Detay</h3>
        <div class="actions">
          <button id="btnDetailClose" class="btn">Kapat</button>
        </div>
      </div>

      <div class="row2">
        <input id="detailSearch" class="inp" placeholder="Detay iÃ§inde ara (Ã¶rn: izin / mazot)" autocomplete="off" />
        <select id="detailQuick" class="inp">
          <option value="all" selected>TÃ¼mÃ¼</option>
          <option value="30">Son 30 gÃ¼n</option>
          <option value="7">Son 7 gÃ¼n</option>
        </select>
      </div>

      <div class="list" id="detailList"></div>
      <div class="footnote">Silme yok âœ… â€¢ DÃ¼zeltme var âœ… â€¢ CanlÄ± yok âœ…</div>
    </div>
  </div>

  <!-- MODAL: DÃ¼zelt -->
  <div class="modalBg" id="editBg" aria-hidden="true">
    <div class="modal">
      <div class="split">
        <h3>âœï¸ KayÄ±t DÃ¼zelt</h3>
        <div class="actions">
          <button id="btnEditCancel" class="btn">VazgeÃ§</button>
        </div>
      </div>

      <div class="meta" id="editInfo"></div>

      <label class="label">GiriÅŸ (YYYY-MM-DD HH:MM)</label>
      <input id="editGiris" class="inp" placeholder="2026-02-10 08:10" />

      <label class="label">Ã‡Ä±kÄ±ÅŸ (boÅŸ bÄ±rakÄ±labilir)</label>
      <input id="editCikis" class="inp" placeholder="2026-02-10 17:05" />

      <label class="label">Not</label>
      <textarea id="editNote" class="inp area" placeholder="Not"></textarea>

      <button id="btnEditSave" class="btn btn-warn">Kaydet</button>
      <div class="footnote">Silme yok âœ… â€¢ Her satÄ±rda DÃœZELT âœ…</div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    window.APP_CFG = {"SUPABASE_URL": "https://ngnpocqaznpuggsvwbif.supabase.co", "ANON_KEY": "sb_publishable_st-oRCixt2NLZnE1CFga6A_fCqdcGZn", "ADMIN_TOKEN": "2550d2afd71062bde89a04d5b2ad55ec502d35a1f9b8ff89"};
  </script>
  <script src="assets/app.js"></script>
</body>
</html>
