<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Personel Takip - Admin</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
body { font-family: Arial; background:#f3f4f6; padding:20px; }
.card { background:#fff; padding:16px; border-radius:14px; margin-bottom:14px; }
input, button { padding:8px; border-radius:8px; border:1px solid #ccc; }
button { cursor:pointer; }
.primary { background:#2563eb; color:white; border:none; }
.danger { background:#dc2626; color:white; border:none; }
table { width:100%; border-collapse:collapse; }
th,td { padding:8px; border-bottom:1px solid #eee; }
th { background:#f9fafb; }
</style>
</head>
<body>

<h2>ðŸ“Š Personel Takip - Admin</h2>

<div class="card">
<h3>ðŸ‘¤ Personel YÃ¶netimi</h3>

<input type="text" id="pAd" placeholder="Ad Soyad">
<input type="password" id="pSifre" placeholder="Åžifre">
<button class="primary" id="btnAddPersonel">Ekle</button>

<table style="margin-top:10px;">
<thead>
<tr>
<th>Ad Soyad</th>
<th>Åžifre</th>
<th>Sil</th>
</tr>
</thead>
<tbody id="personelTable">
<tr><td colspan="3">YÃ¼kleniyor...</td></tr>
</tbody>
</table>
</div>

<script>

const SUPABASE_URL = "https://ngnpocqaznpuggsvwbif.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5nbnBvY3Fhem5wdWdnc3Z3YmlmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA3MDIzNzksImV4cCI6MjA4NjI3ODM3OX0.a2bCf0CfV7Vur6z60Q9O1nBXVdsCPHL3KJTBiEmbpec";

const { createClient } = supabase;
const supabaseClient = createClient(SUPABASE_URL, SUPABASE_KEY);

window.onload = loadPersoneller;

async function loadPersoneller(){

  const { data, error } = await supabaseClient
    .from("personeller")
    .select("*");

  if(error){
    personelTable.innerHTML =
    `<tr><td colspan="3" style="color:red;">Hata</td></tr>`;
    return;
  }

  if(!data || data.length===0){
    personelTable.innerHTML =
    `<tr><td colspan="3">KayÄ±t yok</td></tr>`;
    return;
  }

  personelTable.innerHTML="";

  data.forEach(p=>{
    personelTable.innerHTML += `
    <tr>
      <td>${p.ad_soyad}</td>
      <td>${p.sifre}</td>
      <td><button class="danger" onclick="silPersonel('${p.ad_soyad}')">Sil</button></td>
    </tr>`;
  });
}

btnAddPersonel.onclick = async ()=>{

  const ad = pAd.value.trim();
  const sifre = pSifre.value.trim();

  if(!ad || !sifre) return alert("BoÅŸ bÄ±rakma");

  const { error } = await supabaseClient
    .from("personeller")
    .insert([{ ad_soyad: ad, sifre: sifre }]);

  if(error){
    alert("Ekleme hatasÄ±");
    return;
  }

  pAd.value="";
  pSifre.value="";
  await loadPersoneller();
};

async function silPersonel(ad){

  if(!confirm("Silmek istediÄŸine emin misin?")) return;

  await supabaseClient
    .from("personeller")
    .delete()
    .eq("ad_soyad", ad);

  await loadPersoneller();
}

</script>
</body>
</html>
